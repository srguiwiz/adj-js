<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <title>Adj Framework - Test Suite</title>
  <script type="text/javascript" src="js/adj.js">
  </script>
  <style type="text/css">
th, td {
  padding: 1.0ex;
}
#allTestsTable, #allTestsTable td {
  border: 1px solid;
}
#allTestsTable th {
  padding-bottom: 2.0ex;
  font-family: sans-serif;
  font-size: larger;
}
#allTestsTable th {
  border-bottom: 1px solid;
}
@media print {
  tr, td, img {
    page-break-inside: avoid;
  }
}
h1 {
  font-size: 130%;
}
h2 {
  font-size: 120%;
}
h3 {
  font-size: 110%;
}
h4, h5, h6 {
  font-size: 105%;
}
h1,h2,h3,h4,h5,h6 {
  page-break-after: avoid;
}
 .testInvoked {
  background-color:paleturquoise;
}
 .passedTest {
  background-color:lightgreen;
}
 .failedTest {
  background-color:lightcoral;
}
 .deemphasize {
  font-size: smaller;
}
@font-face {
  font-family: Liberation Mono;
  src: local("Liberation Mono"), local("Liberation Mono Regular"), local("LiberationMono-Regular"), url(fonts/Liberation/LiberationMono-Regular.ttf);
  font-weight: normal;
  font-style: normal;
}
 .liberationMono {
  font-family: "Liberation Mono","Courier New";
}
 .iframes {
  border: 1px solid #000;
}
 .iframes > iframe {
  min-height: 300px;
  height: auto;
  margin: 3px;
  display: inline-block;
}
#tif {
  width: 45%;
  margin-right: 10px;
}
#erif {
  width: 45%;
}
@media screen and (max-width: 600px) {
  #tif {
    width: 95%;
    margin-right: 3px;
  }
  #erif {
    width: 95%;
  }
}
 .caption {
  font-family: sans-serif;
  font-size: smaller;
  font-style: oblique;
  margin-top: 0;
}
  </style>
</head>

<body>
<h1>Adj Framework - Test Suite</h1>

<div class="toc">
<ul>
  <li><a href="#L3557">1. Compatibility</a></li>
  <li><a href="#L2744">2. Run</a></li>
  <li><a href="#L3113">3. History</a></li>
</ul>
</div>

<p>For more about Adj, see the <a href="index.html">user guide</a>.</p>

<h2 id="L3557">1. Compatibility</h2>

<p>This <a href="index.html#L2357">test suite</a> for Adj <a
href="https://github.com/srguiwiz/adj-js">version</a> <strong
class="adjversion">?</strong> so far <a href="#L2744">runs</a> in contemporary
Firefox 45 (Windows, Linux also verified 38), Chrome 49 (Windows, Mac OS X,
Android 4.4), Safari 9 (Mac OS X 10.11, iOS 9.2 on iPhone and iPad), Opera 36
(Windows) and Internet Explorer 11. Do you have other browsers <a
href="index.html#L4276">to report</a>?</p>

<p>Starting in 2015 we <strong>have observed computer virus protection
injecting scripts into web pages</strong>. Such extraneous elements cause this
test suite to incorrectly report failure: Even though having run correctly,
<strong>extraneous elements don't identifiably match expected results</strong>.
If encountered, there is a known workaround: <strong>Run this test suite on a
machine without that specific virus protection</strong>. Annoyingly, "Pause
protectionâ€¦" doesn't stop script injection with at least one well known brand
name.</p>

<p>Font metrics differences between browsers still are a challenge. In this
context, a functioning test suite is a challenge of its own. Problems are not
always an indication of a problem with Adj itself. Nevertheless, having and
using this test suite is much better than not having or not using it.</p>

<p>In addition to other font metric related issues, some versions of WebKit
based browsers may have an issue apparently still loading web based fonts while
already drawing an SVG image and hence not knowing the correct metric yet. This
seems to be more noticeable on the weaker CPU of a mobile device, such as an
iPad. If that would cause test failures then simply <strong>running this test
suite a second time appears to work better</strong>, possibly because the font
might be cached on the device already. Maybe this page loading the font <span
class="liberationMono">here</span> already helps too.</p>

<p>Furthermore, with an earlier version of this test suite, it had been
observed that apparently hanging (not completing) tests with asynchronous code
<span class="deemphasize">(testing command <a
href="index.html#L3450"><code>include</code></a>)</span> often would
<strong>succed when run a second time</strong>.</p>

<h2 id="L2744">2. Run</h2>

<div class="iframes">
<iframe id="tif" name="tif" src="test-adj-ex-002-verticalList.svg">
If you see this text then your browser doesn't support iframes.</iframe>
<iframe id="erif" name="erif" src="test-adj-ex-002-verticalList-result.svg">
If you see this text then your browser doesn't support iframes.</iframe>
</div>

<p class="caption">Test <span class="progressCurrent">?</span> of of <span
class="progressTotal">?</span>.</p>

<p>Normally you'd want to 
<input name="" type="button" onclick="runThroughAllDocuments();"
value="Run All Tests" />. To start over cleanly, reload your browser window.</p>

<p>Sometimes, if needed, after selecting a file below, once you see it above,
you can 
<input name="" type="button" onclick="runOneDocument();" value="Run One Test"
/>.</p>

<p>To help debugging, after selecting a file below, once you see it above, you
can force an 
<input name="" type="button" onclick="forceAnAdjDoSvg();" value="Adj.doSvg()"
/>.</p>

<table id="allTestsTable">
  <thead>
    <tr>
      <th>Adj version <strong class="adjversion">?</strong></th>
      <th class="totalPassOrFail">?</th>
    </tr>
  </thead>
  <tbody id="tb">
    <tr>
      <td><a href="#">test-adj-ex-002-verticalList.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-003-horizontalList.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-004-frameForParent.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-005-textBreaks.svg</a><br />
        <span class="deemphasize">has text, may suffer from font metrics
        differences</span></td>
      <td><p>?</p>
      </td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-006-connection.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-007-rider.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-008-circleForParent.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-009-ellipseForParent.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-010-circularList.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-023-connection-fromXY-explained.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-045-verticalTree.svg</a><br />
        <span class="deemphasize">has text, may suffer from font metrics
        differences</span></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-051-horizontalTree.svg</a><br />
        <span class="deemphasize">has text, may suffer from font metrics
        differences</span></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-053-vine.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-054-floater.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-056-explain-path-transform.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-057b-variable-scope.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-060-fit.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-061-stackFrames.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-063-zoomFrames.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-066-tilt.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-068-skimpyList.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-070-pinnedList.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-072-hide.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-075-telescopicTree.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a
      href="#">test-adj-ex-075-telescopicTree-motley-explained.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-077-paragraph.svg</a><br />
        <span class="deemphasize">has text, may suffer from font metrics
        differences</span></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-077-paragraph-issue-12a.svg</a><br />
        <span class="deemphasize">has text, may suffer from font metrics
        differences</span></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-078-paragraph-hAlign.svg</a><br />
        <span class="deemphasize">has text, may suffer from font metrics
        differences</span></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-082-pathArrow.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a
      href="#">test-adj-ex-084-pathArrow-nockSetback-pointSetback.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-086-pathArrow-arithmetic.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-087-circularList-packArc.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-090-rcGrid-motley.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-091-rcGrid-templates.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-093-sliderKnob-step-motley.svg</a></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-080-include.svg</a><br />
        <span class="deemphasize">known to fail in file:// scheme unless
        browser permits or is set to permit;</span><br />
        <span class="deemphasize">if so then you should try running in http://
        scheme, e.g. <a
        href="https://srguiwiz.github.com/adj-js/user-docs/tests.html">here</a></span></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-081-include-fragment.svg</a><br />
        <span class="deemphasize">known to fail in file:// scheme unless
        browser permits or is set to permit;</span><br />
        <span class="deemphasize">if so then you should try running in http://
        scheme, e.g. <a
        href="https://srguiwiz.github.com/adj-js/user-docs/tests.html">here</a></span></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-002-verticalList.html</a> HTML</td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-023-connection-fromXY-explained.html</a>
      HTML</td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-063-zoomFrames.html</a> HTML</td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-075-telescopicTree-motley-explained.html</a>
        HTML</td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-090-rcGrid-motley.html</a> HTML</td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-091-rcGrid-templates.html</a> HTML</td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-080-include.html</a> HTML<br />
        <span class="deemphasize">known to fail in file:// scheme unless
        browser permits or is set to permit;</span><br />
        <span class="deemphasize">if so then you should try running in http://
        scheme, e.g. <a
        href="https://srguiwiz.github.com/adj-js/user-docs/tests.html">here</a></span></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-002-verticalList-and-more.html</a> HTML<br />
        <span class="deemphasize">known to fail in file:// scheme unless
        browser permits or is set to permit;</span><br />
        <span class="deemphasize">if so then you should try running in http://
        scheme, e.g. <a
        href="https://srguiwiz.github.com/adj-js/user-docs/tests.html">here</a></span></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-081-include-fragment-from-html.html</a><br />
        <span class="deemphasize">known to fail in file:// scheme unless
        browser permits or is set to permit;</span><br />
        <span class="deemphasize">if so then you should try running in http://
        scheme, e.g. <a
        href="https://srguiwiz.github.com/adj-js/user-docs/tests.html">here</a></span></td>
      <td>?</td>
    </tr>
    <tr>
      <td><a href="#">test-adj-ex-081-include-fragment-from-html.svg</a><br />
        <span class="deemphasize">known to fail in file:// scheme unless
        browser permits or is set to permit;</span><br />
        <span class="deemphasize">if so then you should try running in http://
        scheme, e.g. <a
        href="https://srguiwiz.github.com/adj-js/user-docs/tests.html">here</a></span></td>
      <td>?</td>
    </tr>
  </tbody>
</table>

<h2 id="L3113">3. History</h2>

<p>Compatibility to older versions browsers is not currently verified. This
test suite, however, has been run and updated, for what it's worth, since
Firefox 24, Chrome 35, Safari 5, and Internet Explorer 10.</p>
<script type="text/javascript">
//<![CDATA[
//
// Simplified BSD License
//
// Copyright (c) 2002-2016, Nirvana Research
// All rights reserved.
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are met:
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDER AND CONTRIBUTORS "AS IS" AND
// ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
// WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
// ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
// (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
// LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
// ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
// SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
// ==============================================================================
//
// Idea and first implementation - Leo Baschy <srguiwiz12 AT nrvr DOT com>
//
// ==============================================================================
//
// Project contact: <adj.project AT nrvr DOT com>
//
// ==============================================================================
//
// Public repository - https://github.com/srguiwiz/adj-js
//

// note:  this testing code is maintained with somewhat different, not to say lesser,
// criteria than the library proper

	var versionInstances = document.querySelectorAll('.adjversion');
	for (var i = 0, n = versionInstances.length; i < n; i++) {
		versionInstances[i].innerHTML=Adj.version.major+'.'+Adj.version.minor+'.'+Adj.version.revision;
	}

	var testIframe = document.getElementById("tif");
	var expectedResultIframe = document.getElementById("erif");
	var tbody = document.getElementById("tb");
	var trs = tbody.getElementsByTagName("tr");
	var current = -1;
	var thisPageLocation = window.location.href;
	var thisPageLocationDirectory = thisPageLocation.substring(0, thisPageLocation.lastIndexOf("/") + 1);
	var indexesByUrl = {};
	//
	var ranSomethingAlready = false;
	var runOnlyOne = true;
	var loadButDontRunYet = true;
	//
	var waitForTifLoaded = true;
	var waitForErifLoaded = true;
	//
	var totalPassed = 0;

	var progressTotalInstances = document.querySelectorAll('.progressTotal');
	for (var i = 0, n = progressTotalInstances.length; i < n; i++) {
		progressTotalInstances[i].innerHTML = trs.length;
	}

	function makeAbsoluteAddress(address) {
		if (address.indexOf("://") < 0) {
			address = thisPageLocationDirectory + address;
		}
		return address;
	}

	function initializeSome() {
		for (var i = 0, n = trs.length; i < n; i++) {
			var tr = trs[i];
			var tds = tr.getElementsByTagName("td");
			var tdFile = tds[0];
			var a = tdFile.getElementsByTagName("a")[0];
			//var address = a.getAttribute("href");
			var address = a.textContent.trim();
			address = makeAbsoluteAddress(address);
			indexesByUrl[address] = i;
		}
		//
		testIframe.setAttribute("onload", "tifLoaded()");
		expectedResultIframe.setAttribute("onload", "erifLoaded()");
	}
	initializeSome();

	function runThroughAllDocuments() {
		if (ranSomethingAlready) {
			alert("You must reload your browser window first.");
			return;
		}
		ranSomethingAlready = true;
		runOnlyOne = false;
		loadButDontRunYet = false;
		loadFileByNumber(current);
	}

	function runOneDocument() {
//		if (ranSomethingAlready) {
//			alert("You must reload your browser window first.");
//			return;
//		}
		ranSomethingAlready = true;
		runOnlyOne = true;
		loadButDontRunYet = false;
		expectedResultIframe.contentWindow.postMessage("Adj.encodeDocument|", "*");
	}

	function loadFileByNumber(number) {
		if (number === undefined) {
			number = current;
		}
		if (number >= 0 && number < trs.length) {
			var tr = trs[number];
			var tds = tr.getElementsByTagName("td");
			var tdFile = tds[0];
			var a = tdFile.getElementsByTagName("a")[0];
			var testAddress = a.textContent.trim();
			var expectedResultAddress = testAddress.replace(/^(.*?)(\.[^.]*|)$/, "$1-result$2");
			testAddress = makeAbsoluteAddress(testAddress);
			expectedResultAddress = makeAbsoluteAddress(expectedResultAddress);
			console.log("going to load #" + number + " = " + testAddress + " and " + expectedResultAddress);
			current = number;
			waitForTifLoaded = true;
			waitForErifLoaded = true;
			testIframe.src = testAddress;
			expectedResultIframe.src = expectedResultAddress;
			//testIframe.contentWindow.postMessage("load|" + testAddress, "*");
			//expectedResultIframe.contentWindow.postMessage("load|" + expectedResultAddress, "*");
			//
			var progressCurrentInstances = document.querySelectorAll('.progressCurrent');
			for (var i = 0, n = progressCurrentInstances.length; i < n; i++) {
				progressCurrentInstances[i].innerHTML = current + 1;
			}
		} else {
			current = -1;
			waitForTifLoaded = true;
			waitForErifLoaded = true;
			testIframe.src = "about:blank";
			expectedResultIframe.src = "about:blank";
		}
	}

	function tifLoaded() {
		console.log("tif loaded");
		waitForTifLoaded = false;
		if (!waitForErifLoaded) {
			bothLoaded();
		}
	}

	function erifLoaded() {
		console.log("erif loaded");
		waitForErifLoaded = false;
		if (!waitForTifLoaded) {
			bothLoaded();
		}
	}

	function bothLoaded() {
		console.log("both loaded, test number ", current);
		if (loadButDontRunYet) { // flag
			return;
		}
		var tr = trs[current];
		var tds = tr.getElementsByTagName("td");
		var tdResult = tds[1];
		// wait less than a second, for font metrics to work better in some browsers
		tdResult.setAttribute("class", "testInvoked");
		tdResult.textContent = "waiting";
		window.setTimeout(function(){
			// invoke test
			tdResult.setAttribute("class", "testInvoked");
			tdResult.textContent = "recollecting";
			expectedResultIframe.contentWindow.postMessage("Adj.encodeDocument|", "*");
		}, 300);
	}

	// match command by itself, or command followed by one or two parameters separated by |
	var messageRegexp = /^([^|]*)(?:\|([^|]*))?(?:\|(.*))?$/;

	var windowReceivesMessage = function windowReceivesMessage(evt) {
		// accept any evt.origin
		var messageMatch = messageRegexp.exec(evt.data);
		if (messageMatch) {
			var messageCommand = messageMatch[1];
			var messageParameter1 = messageMatch[2];
			var messageParameter2 = messageMatch[3];
		} else {
			messageCommand = "";
		}
		var iterate = false;
		switch (messageCommand) {
			case "Adj.encodedDocument":
			case "Adj.encodedDocumentException":
				if (messageCommand == "Adj.encodedDocument") {
					var encodedDocument = messageParameter2;
					console.log("got encodedDocument from ", messageParameter1);
					//
					var tr = trs[current];
					var tds = tr.getElementsByTagName("td");
					var tdResult = tds[1];
					tdResult.setAttribute("class", "testInvoked");
					tdResult.textContent = "invoking and verifying";
					//
					testIframe.contentWindow.postMessage("Adj.doSvgAndVerify|" + encodedDocument, "*");
				} else { // exception
					displayTestResult(messageParameter1,messageParameter2,true);
					iterate = true;
				}
				break;
			case "Adj.didSvgAndVerify":
			case "Adj.didSvgAndVerifyException":
				if (messageCommand == "Adj.didSvgAndVerify") {
					displayTestResult(messageParameter1,messageParameter2,false);
				} else { // exception
					displayTestResult(messageParameter1,messageParameter2,true);
				}
				iterate = true;
				break;
			default:
		}
		if (iterate) {
			if (!runOnlyOne) {
				// wait less than a second, to allow a user to catch a glimpse of the image
				window.setTimeout(function(){
					continueToNext();
				}, 700);
			}
		}
	}

	// see https://developer.mozilla.org/en-US/docs/DOM/window.postMessage
	window.addEventListener("message", windowReceivesMessage, false);

	function displayTestResult(testedUrl, testResult, wasException) {
		var index = indexesByUrl[testedUrl];
		if (typeof index != "number") {
			console.log("cannot figure what row has URL " + testedUrl);
			return;
		}
		var tr = trs[index];
		var tds = tr.getElementsByTagName("td");
		var tdResult = tds[1];
		var passed = false;
		if (!wasException) {
			if (!testResult) { // empty string if expected result == success
				if (!tdResult.classList.contains("passedTest")) {
					totalPassed++;
				}
				tdResult.setAttribute("class","passedTest");
				tdResult.textContent = "PASSED";
				passed = true;
			} else {
				tdResult.setAttribute("class","failedTest");
				tdResult.textContent = "FAILED with: " + testResult;
			}
		} else {
			tdResult.setAttribute("class","failedTest");
			tdResult.textContent = "FAILED with exception: " + testResult;
		}
		//if (!runOnlyOne) {
		if (passed) {
			if (totalPassed >= trs.length) {
				var allPassed = true;
				// double check
				for (var i = 0, n = trs.length; i < n; i++) {
					if (!trs[i].getElementsByTagName("td")[1].classList.contains("passedTest")) {
						allPassed = false;
						break;
					}
				}
				if (allPassed) {
					var totalPassOrFailInstances = document.querySelectorAll('.totalPassOrFail');
					for (var i = 0, n = totalPassOrFailInstances.length; i < n; i++) {
						totalPassOrFailInstances[i].classList.add("passedTest");
						totalPassOrFailInstances[i].textContent = "ALL PASSED";
					}
				}
			}
		} else { // !passed
			var totalPassOrFailInstances = document.querySelectorAll('.totalPassOrFail');
			for (var i = 0, n = totalPassOrFailInstances.length; i < n; i++) {
				totalPassOrFailInstances[i].classList.add("failedTest");
				totalPassOrFailInstances[i].textContent = "FAILED";
			}
		}
		//}
	}

	function continueToNext() {
		// continue to next row / file
		current += 1;
		if (current < trs.length) {
			loadFileByNumber(current);
		}
	}

	function forceAnAdjDoSvg() {
		ranSomethingAlready = true;
		testIframe.contentWindow.postMessage("Adj.doSvg|", "*");
	}

	document.addEventListener("click", function (event) {
		var target = event.target;
		var href = target.getAttribute("href");
		if (href !== "#") { // another link
			return; // let it function normally
		}
		var ancestor = target.parentElement;
		var rowIndex = -1;
		while (ancestor) {
			if (ancestor.tagName === "TR") {
				// row number needed
				rowIndex = ancestor.sectionRowIndex;
			}
			if (ancestor.getAttribute("id") === "tb") { // indeed in <tbody id="tb">
				break;
			}
			ancestor = ancestor.parentElement;
		}
		console.log(target, rowIndex, ancestor);
		if (!ancestor) { // not in <tbody id="tb">
			return; // let it function normally
		}
		event.preventDefault();
		//
		runOnlyOne = true;
		loadButDontRunYet = true;
		loadFileByNumber(rowIndex);
	});

	loadFileByNumber(0);
//]]></script>
</body>
</html>
